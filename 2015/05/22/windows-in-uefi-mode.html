<!DOCTYPE html><html><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><script type=text/javascript>var host="vjudge1.github.io";host==window.location.host&&"https:"!=window.location.protocol&&(window.location.protocol="https");</script><title>Windows in UEFI Mode</title><meta name=description content="This article is the summary of my own experience on UEFI and Legacy Mode. So some information may be wrong.Experiences about installing an operating system (..."><link rel=stylesheet href=/css/main.css><link rel=stylesheet type=text/css href=//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.min.css><link rel=canonical href=https://vjudge1.github.io/2015/05/22/windows-in-uefi-mode.html><link rel=alternate type=application/rss+xml title=Unorz href="https://vjudge1.github.io/feed.xml"><link type=application/atom+xml rel=alternate href=https://vjudge1.github.io/feed.xml><script type=text/javascript src=//cdnjs.cloudflare.com/ajax/libs/jquery/1.11.3/jquery.min.js></script><script type=text/javascript src=//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.4/js/bootstrap.min.js></script>--><script type=text/javascript src=/static/js/index.js></script></head><body><header><nav class="navbar navbar-default"><div class=container><div class=navbar-header><button type=button class="navbar-toggle navbar-toggle-left collapsed" data-toggle=modal data-target=#nav-sidebar><span class=sr-only>Toggle navigation</span> <span class=icon-bar></span> <span class=icon-bar></span> <span class=icon-bar></span></button> <button type=button class="navbar-toggle collapsed" data-toggle=collapse data-target=#navbar aria-expanded=false aria-controls=navbar><span class=sr-only>Toggle navigation</span> <span class="fa fa-angle-double-right icon"></span></button> <a class=navbar-brand href="/"><i class="fa fa-github-alt"></i> Unorz</a></div><div id=navbar class="collapse navbar-collapse"><ul class="nav navbar-nav navbar-right"><li><a href=/ data-toggle=tooltip data-placement=bottom title=Home><i class="fa fa-home"></i></a></li><li class=dropdown><a href=# class=dropdown-toggle data-toggle=dropdown role=button aria-expanded=true data-toggle=tooltip data-placement=bottom title=Categories><i class="fa fa-th-list"></i><span class=caret></span></a><ul class=dropdown-menu role=menu><li><a href="/categories/?c=All"><span class=badge style=float:right>38</span>All</a></li><li class=divider></li><li class=dropdown-header>Lists</li><li><a href="/categories/?c=Others"><span class=badge style=float:right>6</span>Others</a></li><li><a href="/categories/?c=Linux"><span class=badge style=float:right>11</span>Linux</a></li><li><a href="/categories/?c=Maintainance"><span class=badge style=float:right>3</span>Maintainance</a></li><li><a href="/categories/?c=Mac"><span class=badge style=float:right>5</span>Mac</a></li><li><a href="/categories/?c=GitHub"><span class=badge style=float:right>4</span>GitHub</a></li><li><a href="/categories/?c=Arduino"><span class=badge style=float:right>1</span>Arduino</a></li><li><a href="/categories/?c=fun"><span class=badge style=float:right>2</span>fun</a></li><li><a href="/categories/?c=Web"><span class=badge style=float:right>6</span>Web</a></li><li><a href="/categories/?c=others"><span class=badge style=float:right>1</span>others</a></li><li><a href="/categories/?c=Ruby"><span class=badge style=float:right>1</span>Ruby</a></li><li><a href="/categories/?c=Programming"><span class=badge style=float:right>3</span>Programming</a></li><li><a href="/categories/?c=Fun"><span class=badge style=float:right>1</span>Fun</a></li></ul></li><li><a href=/tags/ data-toggle=tooltip data-placement=bottom title=Tags><i class="fa fa-tags"></i></a></li><li><a href=/about/ data-toggle=tooltip data-placement=bottom title=About><i class="fa fa-file-o"></i></a></li><li><a href=https://github.com/vjudge1/vjudge1.github.io data-toggle=tooltip data-placement=bottom title="Source Code"><i class="fa fa-code icon"></i></a></li><li><a href=/feed.xml data-toggle=tooltip data-placement=bottom title=RSS><i class="fa fa-rss icon"></i></a></li></ul><form class="navbar-form navbar-right hidden-sm hidden-md hidden-lg" action="/search/"><div class=form-group><input placeholder=Regexp class=form-control name=s id=keyword></div></form></div></div></nav></header><div class=modal id=nav-sidebar tabindex=-1 role=dialog aria-labelledby=myModalLabel aria-hidden=true><div class="modal-dialog nav-sidebar"><div class=title><a class=navbar-brand href="/">Unorz</a></div><div class=content id=nav-sidebar-content><h4 class="page-header text-muted"><i class="fa fa-search"></i> Search</h4><form action="/search/"><div class=form-group><input placeholder=Regexp class=form-control name=s id=keyword></div></form><h4 class="page-header text-muted"><i class="fa fa-th-list"></i> Categories</h4><div class=categories-list><a class=item href="/categories/?c=All" data-cate=All>All <span class=badge>38</span></a> <a class=item href="/categories/?c=Others" data-cate=Others>Others <span class=badge>6</span></a> <a class=item href="/categories/?c=Linux" data-cate=Linux>Linux <span class=badge>11</span></a> <a class=item href="/categories/?c=Maintainance" data-cate=Maintainance>Maintainance <span class=badge>3</span></a> <a class=item href="/categories/?c=Mac" data-cate=Mac>Mac <span class=badge>5</span></a> <a class=item href="/categories/?c=GitHub" data-cate=GitHub>GitHub <span class=badge>4</span></a> <a class=item href="/categories/?c=Arduino" data-cate=Arduino>Arduino <span class=badge>1</span></a> <a class=item href="/categories/?c=fun" data-cate=fun>fun <span class=badge>2</span></a> <a class=item href="/categories/?c=Web" data-cate=Web>Web <span class=badge>6</span></a> <a class=item href="/categories/?c=others" data-cate=others>others <span class=badge>1</span></a> <a class=item href="/categories/?c=Ruby" data-cate=Ruby>Ruby <span class=badge>1</span></a> <a class=item href="/categories/?c=Programming" data-cate=Programming>Programming <span class=badge>3</span></a> <a class=item href="/categories/?c=Fun" data-cate=Fun>Fun <span class=badge>1</span></a></div><h4 class="page-header text-muted"><i class="fa fa-tags"></i> Tags</h4><a href=/tags/#tag-Linux style=font-size:13.5pt;color:#444 data-toggle=tooltip data-placement=top title="2 articles">Linux</a>&nbsp; <a href=/tags/#tag-中文 style=font-size:9pt;color:#999 data-toggle=tooltip data-placement=top title="1 article">中文</a>&nbsp; <a href=/tags/#tag-Hackintosh style=font-size:18pt;color:#000 data-toggle=tooltip data-placement=top title="3 articles">Hackintosh</a>&nbsp; <a href=/tags/#tag-UEFI style=font-size:13.5pt;color:#444 data-toggle=tooltip data-placement=top title="2 articles">UEFI</a>&nbsp; <a href=/tags/#tag-单片机 style=font-size:9pt;color:#999 data-toggle=tooltip data-placement=top title="1 article">单片机</a>&nbsp; <a href=/tags/#tag-Jekyll style=font-size:13.5pt;color:#444 data-toggle=tooltip data-placement=top title="2 articles">Jekyll</a>&nbsp; <a href=/tags/#tag-GitHub style=font-size:18pt;color:#000 data-toggle=tooltip data-placement=top title="3 articles">GitHub</a>&nbsp; <a href=/tags/#tag-Scripting style=font-size:13.5pt;color:#444 data-toggle=tooltip data-placement=top title="2 articles">Scripting</a>&nbsp; <a href=/tags/#tag-Arduino style=font-size:9pt;color:#999 data-toggle=tooltip data-placement=top title="1 article">Arduino</a>&nbsp; <a href=/tags/#tag-Wireless style=font-size:13.5pt;color:#444 data-toggle=tooltip data-placement=top title="2 articles">Wireless</a>&nbsp; <a href=/tags/#tag-hostapd style=font-size:13.5pt;color:#444 data-toggle=tooltip data-placement=top title="2 articles">hostapd</a>&nbsp; <a href=/tags/#tag-Windows style=font-size:9pt;color:#999 data-toggle=tooltip data-placement=top title="1 article">Windows</a>&nbsp; <a href=/tags/#tag-LaTeX style=font-size:9pt;color:#999 data-toggle=tooltip data-placement=top title="1 article">LaTeX</a>&nbsp; <a href=/tags/#tag-Ubuntu style=font-size:9pt;color:#999 data-toggle=tooltip data-placement=top title="1 article">Ubuntu</a>&nbsp; <a href=/tags/#tag-教务系统 style=font-size:9pt;color:#999 data-toggle=tooltip data-placement=top title="1 article">教务系统</a>&nbsp; <a href=/tags/#tag-Mac style=font-size:9pt;color:#999 data-toggle=tooltip data-placement=top title="1 article">Mac</a>&nbsp; <a href=/tags/#tag-NTFS style=font-size:9pt;color:#999 data-toggle=tooltip data-placement=top title="1 article">NTFS</a>&nbsp; <a href=/tags/#tag-Request style=font-size:9pt;color:#999 data-toggle=tooltip data-placement=top title="1 article">Request</a>&nbsp; <a href=/tags/#tag-C style=font-size:13.5pt;color:#444 data-toggle=tooltip data-placement=top title="2 articles">C</a>&nbsp; <a href=/tags/#tag-CGI style=font-size:13.5pt;color:#444 data-toggle=tooltip data-placement=top title="2 articles">CGI</a>&nbsp; <a href=/tags/#tag-Session style=font-size:9pt;color:#999 data-toggle=tooltip data-placement=top title="1 article">Session</a>&nbsp; <a href=/tags/#tag-Synergy style=font-size:9pt;color:#999 data-toggle=tooltip data-placement=top title="1 article">Synergy</a>&nbsp; <a href=/tags/#tag-Rails style=font-size:9pt;color:#999 data-toggle=tooltip data-placement=top title="1 article">Rails</a>&nbsp; <a href=/tags/#tag-Dash style=font-size:9pt;color:#999 data-toggle=tooltip data-placement=top title="1 article">Dash</a>&nbsp; <a href=/tags/#tag-API style=font-size:9pt;color:#999 data-toggle=tooltip data-placement=top title="1 article">API</a>&nbsp; <a href=/tags/#tag-wine style=font-size:9pt;color:#999 data-toggle=tooltip data-placement=top title="1 article">wine</a>&nbsp; <a href=/tags/#tag-插件 style=font-size:18pt;color:#000 data-toggle=tooltip data-placement=top title="3 articles">插件</a>&nbsp;<h4 class="page-header text-muted"><i class="fa fa-external-link"></i> Links</h4><ul class="link-list fa-ul"><li><i class="fa-li fa fa-link"></i><a href=https://upclinux.github.io data-toggle=tooltip data-placement=bottom title=https://upclinux.github.io>UPC Linux</a></li><li><i class="fa-li fa fa-link"></i><a href=https://upclinux.github.io/intro/ data-toggle=tooltip data-placement=bottom title="https://upclinux.github.io/intro/">UPC Linux / Intro</a></li><li><i class="fa-li fa fa-link"></i><a href=http://www.lihuanyu.com data-toggle=tooltip data-placement=bottom title=http://www.lihuanyu.com>环宇的博客</a></li><li><i class="fa-li fa fa-link"></i><a href=http://wangchenyu.net.cn data-toggle=tooltip data-placement=bottom title=http://wangchenyu.net.cn>微尘风景BBS</a></li><li><i class="fa-li fa fa-link"></i><a href=http://jerry.weighingproduct.com data-toggle=tooltip data-placement=bottom title=http://jerry.weighingproduct.com>Jerry Yuan</a></li></ul></div></div></div><div class=jumbotron><div class=container><h1 class=post-title id=post-title><a href="/">Windows in UEFI Mode</a></h1><p><span class="glyphicon glyphicon-calendar"></span> May 22, 2015 &nbsp;&nbsp;&nbsp;<span class="glyphicon glyphicon-user"></span> vjudge1 &nbsp;&nbsp;&nbsp;<span class="glyphicon glyphicon-th-list"></span> <a href="/categories/?c=Maintainance">Maintainance</a> &nbsp;&nbsp;&nbsp;<span class="glyphicon glyphicon-tags"></span>&nbsp; <a href=/tags/#tag-Windows>Windows</a> <a href=/tags/#tag-UEFI>UEFI</a></p></div></div><div id=main class="container main"><div class=row><div class=col-md-8 role=main><article class=article><ul id=markdown-toc><li><a href=#the-origin id=markdown-toc-the-origin>The origin</a></li><li><a href=#uefi-vs-legacy id=markdown-toc-uefi-vs-legacy>UEFI vs. Legacy</a><ul><li><a href=#booting-via-legacy-mode id=markdown-toc-booting-via-legacy-mode>Booting via Legacy Mode</a></li><li><a href=#booting-via-uefi-mode id=markdown-toc-booting-via-uefi-mode>Booting via UEFI Mode</a></li><li><a href=#secure-boot id=markdown-toc-secure-boot>Secure Boot</a></li><li><a href=#switch-uefi--legacy id=markdown-toc-switch-uefi--legacy>Switch UEFI &amp; Legacy</a></li><li><a href=#enter-bios-setup-with-windows-8-pre-installed id=markdown-toc-enter-bios-setup-with-windows-8-pre-installed>Enter BIOS Setup with Windows 8 pre-installed</a></li></ul></li><li><a href=#gpt-vs-mbr id=markdown-toc-gpt-vs-mbr>GPT vs. MBR</a><ul><li><a href=#advantages-of-gpt id=markdown-toc-advantages-of-gpt>Advantages of GPT</a></li><li><a href=#what-mbr-looks-like id=markdown-toc-what-mbr-looks-like>What MBR looks like</a></li><li><a href=#what-gpt-looks-like id=markdown-toc-what-gpt-looks-like>What GPT looks like</a></li><li><a href=#brand-name-computers id=markdown-toc-brand-name-computers>Brand-name Computers</a></li></ul></li><li><a href=#windows-support id=markdown-toc-windows-support>Windows Support</a><ul><li><a href=#old-windows-2003-or-older id=markdown-toc-old-windows-2003-or-older>Old Windows (2003 or older)</a></li><li><a href=#new-windows-vista-or-newer id=markdown-toc-new-windows-vista-or-newer>New Windows (Vista or newer)</a></li><li><a href=#loseless-change id=markdown-toc-loseless-change>Loseless CHANGE</a></li><li><a href=#notes-on-installing-windows id=markdown-toc-notes-on-installing-windows>Notes on installing Windows</a></li></ul></li><li><a href=#linux-support id=markdown-toc-linux-support>Linux Support</a></li><li><a href=#os-x-support id=markdown-toc-os-x-support>OS X Support</a><ul><li><a href=#mac id=markdown-toc-mac>Mac</a></li><li><a href=#hackintosh id=markdown-toc-hackintosh>Hackintosh</a></li></ul></li></ul><p>This article is the summary of my own experience on UEFI and Legacy Mode. So some information may be wrong.</p><p>Experiences about installing an operating system (e.g., Windows or Linux) are required or you may feel hard to understand it.</p><h1 id=the-origin>The origin</h1><p>It was easy to install a Windows system in the past until the popularity of Windows 8. Laptops with Windows 8 pre-installed adopt the newest firmware named UEFI.</p><p>Differences between UEFI and traditional mode are great. While, both of them also exist at the same time. Therefore it’s important to understand these two modes in order to manage to install operating systems in different computers.</p><h1 id=uefi-vs-legacy>UEFI vs. Legacy</h1><p><a href=https://en.wikipedia.org/wiki/BIOS>BIOS</a>, which names “Basic Input/Output System”, are used in old computers.</p><p>It will be loaded firstly after the computer powers on. Then, the computer will do self-check, load bootloader and boot the OS.</p><p>BIOS is too old to meet the development of computer hardware. For example, addressability of BIOS is just 16-bit, and it’s hard to create an extension for BIOS.</p><p>So there is a substitution and a new standard called EFI. EFI was initially developed by Intel. It was transfered to UEFI Forum and renamed to UEFI.</p><p><a href=https://en.wikipedia.org/wiki/UEFI>UEFI</a> (Unified Extensible Firmware Interface) works like a tiny operating system. Some computers have a built-in EFI Shell, so maintainance work can be done without any other tools.</p><h2 id=booting-via-legacy-mode>Booting via Legacy Mode</h2><p>The following description is based my experience. You can refer to Wikipedia to read <a href=https://en.wikipedia.org/wiki/Master_boot_record>the more accurate process</a>.</p><ul><li>BIOS will read information in <code class=highlighter-rouge>Sector 0</code> in the hard drive. Sector 0 is just 512 bytes, including a program, make BIOS locate to the active partition.</li><li>Finding <code class=highlighter-rouge>the active partition</code> and read information from it.</li><li>Boot the bootloader according to codes inside the partition.</li><li>Boot the OS by the bootloader.</li></ul><p>Bootloaders of Windows:</p><ul><li>DOS and Windows based on DOS (until Windows Me) are not booting through specialized startup managers. Unless you fix the bootloader manually, NT-based systems can’t be booted if you install Windows 9x after NT.</li><li>Windows NT series (3.5 to 2003) use <code class=highlighter-rouge>NTLDR</code>. NTLDR is compatible with older systems via chain loading. The configuration file is called Boot.ini.</li><li>New NT systems (Vista or newer) use <code class=highlighter-rouge>Windows Boot Manager</code>. The configuration file is named BCD. BCD is a binary file like a Windows registry file and can be edited by <code class=highlighter-rouge>bcdedit.exe</code>. It can even boot an image in WIM format.</li></ul><h2 id=booting-via-uefi-mode>Booting via UEFI Mode</h2><p>Nowadays, laptops use 64-bit UEFI. At the same time 32-bit UEFI are used in some tablets.</p><p>UEFI will search and execute <code class=highlighter-rouge>EFI\Boot\bootx64.efi</code> in startup disks (e.g., hard drives, CDs or USB flash disks) after power on. Then this program continues to search and execute bootloaders. Finally, the OS is booted.</p><p>Making a bootable USB drive for UEFI mode is quite easy – just extract the installation image to root directory of USB drive by extraction software, and, it’s OK.</p><p>It should be noted that a 32-bit OS can’t be installed via UEFI mode in laptops. However, some tablets may be OK.</p><h2 id=secure-boot>Secure Boot</h2><p>Secure Boot is a feature of UEFI. If Secure Boot is on, the firmware will verify signature of the bootloader and it will refuse to boot if the signature is not existed or not valid.</p><p>This feature is widely used on Windows 8. It’s considered a restriction because users may not be able to install Linux or other systems (even including Windows 7 and older Windows systems).</p><p>Fortunately, Secure Boot can be closed in PCs and Windows will still work. If a warning message is appeared in the bottom right corner in the desktop, please install patches via Windows Update.</p><p>Microsoft forbids users disable Secure Boot in other devices like Windows RT or phones with Windows installed. So you can’t change OS for these devices.</p><p>Microsoft will force OEMS to enable Secure Boot after Windows 10 published, and whether Secure Boot can be disabled or not will be determined by OEM. Therefore I don’t know whether I can change systems easily in the future.</p><p>Secure Boot can’t be disabled directly in some computers. Please try to set a BIOS password in this case.</p><h2 id=switch-uefi--legacy>Switch UEFI &amp; Legacy</h2><p>All of laptops which is not too old adpot EFI mode at present. However there are no switches in some laptops (Although EFI is really used).</p><p>The number of manufacturers of BIOS is small while the number of OEMs is large. OEMs may customize BIOS so details of the following steps will not be the same.</p><p>First Enter <code class=highlighter-rouge>BIOS Setup</code> (Maybe F2, F8, Delete or other keys) and get <code class=highlighter-rouge>Boot</code> page.</p><ul><li>If you see something like <code class=highlighter-rouge>Boot Mode</code> or <code class=highlighter-rouge>UEFI Boot Option</code>, you can switch these two modes.</li><li>Some computers have <code class=highlighter-rouge>UEFI Priority Order</code> with <code class=highlighter-rouge>UEFI First</code> or <code class=highlighter-rouge>Legacy First</code>. It’s also a way of changing boot modes (Adjusting the priority).</li><li>Some computers have <code class=highlighter-rouge>CSM Support</code>. It is the support of Legacy Mode. However, it’s still UEFI prefered.</li><li>Some computers have no similar options. Just two kinds of circumstances:<ul><li>The computer doesn’t support EFI at all.</li><li>The computer supports EFI and EFI prefered. It will boot via EFI mode as long as bootx64 exists no matter whether boot information for traditional mode exists.</li><li>You can prove this by extracting a 64-bit Windows 8 ISO to a clean USB drive which has no boot code.</li></ul></li></ul><h2 id=enter-bios-setup-with-windows-8-pre-installed>Enter BIOS Setup with Windows 8 pre-installed</h2><p>Some computers don’t show messages like “Press F2 to setup”, don’t enter BIOS Setup by pressing F2 and always startup Windows 8 directly.</p><p>You can do the following steps in this case:</p><ol><li>Go into Windows 8.</li><li>Reboot with <code class=highlighter-rouge>Shift</code> key pushed</li><li>A diagnosis interface will show. Select <code class=highlighter-rouge>Troubleshooting</code>, <code class=highlighter-rouge>Advanced Settings</code>, <code class=highlighter-rouge>UEFI Firmware Settings</code>.</li><li>Press <code class=highlighter-rouge>Restart</code> button and BIOS Setup will be entered automatically.</li></ol><h1 id=gpt-vs-mbr>GPT vs. MBR</h1><p>I will only introduce what they “look like”. I won’t consider SCSI, RAID or dynamic paritions…</p><h2 id=advantages-of-gpt>Advantages of GPT</h2><ul><li>GPT supports partitions greater than 2TB.</li><li>GPT supports over 4 main partitions. There are at most 4 main partitions in MBR drives (and logical partitions are used to support more partitions).</li></ul><h2 id=what-mbr-looks-like>What MBR looks like</h2><p>In general, people are used to divide an MBR disk into a primary partition (C:, /dev/sda1) and an extended partition (/dev/sda2). Other partitions are contained in the extended partition (from /dev/sda5).</p><p><img src=/img/mbr.png alt="mbr"></p><h2 id=what-gpt-looks-like>What GPT looks like</h2><p>All of partitions in GPT disks are primary partition. The first partition using FAT32 filesystem is ESP (EFI System Partition).</p><p><img src=/img/gpt1.png alt="gpt1"></p><h2 id=brand-name-computers>Brand-name Computers</h2><p>Some brand-name computers have a easy-to-use recovery tool like “OneKey”. So there are some dedicated partitions saving recovery programs or original system images. You can’t alloc drive letters to these partitions directly.</p><p><img src=/img/gpt2.png alt="gpt2"></p><h1 id=windows-support>Windows Support</h1><h2 id=old-windows-2003-or-older>Old Windows (2003 or older)</h2><p>Windows XP or older only supports Legacy + MBR and can’t detect GPT drives.</p><p>Windows 2003 can detect GPT drives although can’t boot in them.</p><h2 id=new-windows-vista-or-newer>New Windows (Vista or newer)</h2><ul><li>32-bit Windows doesn’t support UEFI except some tablets.</li><li>64-bit Windows only supports UEFI + GPT and Legacy + MBR.</li></ul><p>In fact, UEFI &amp; Legacy, GPT &amp; MBR can be combined casually. However, Windows and Windows Installer will only work in supported mode.</p><p>If you got wrong mode when installing Windows, you will find no partition can be installed to and receive an error message like this:</p><ul><li>Windows cannot be installed on this drive. The selected disk has an MBR partition table. On EFI systems, Windows can only be installed to GPT disk.</li><li>Windows cannot be installed on this drive. The selected disk has an GPT partition table.</li></ul><p>In this case, you need reboot and use the correct mode to boot.</p><p>In addition, you can use partitioning tool like <code class=highlighter-rouge>diskpart</code> to rebuild partition table if you are not afraid of data loss.</p><h2 id=loseless-change>Loseless CHANGE</h2><p>Switching GPT/MBR will wipe all datas in the drive. However, this process can be done loselessly with the help of some professional softwares.</p><p>WARNING: It may still cause data loss. So avoid trying this in an important device!</p><p>Before this, you need a startup disk with DiskGenius (It’s Chinese interface). There are plenty of tools in China such as <a href=http://www.dabaicai.com>Dabaicai</a> and <a href=http://www.laomaotao.net>LaoMaoTao</a>…</p><p>(1) UEFI + GPT =&gt; Legacy + MBR</p><p>DiskGenius can convert GPT from/to MBR loselessly.</p><p>WARNING: Because MBR only supports at most 4 main partitions, data may lose while converting.</p><ul><li>Use DiskGenius to convert.</li><li>Set the partition containing Windows as the active partition.</li><li>Fix boot by typing the following command in Command Prompt:</li></ul><figure class=highlight><pre><code class=language-bat data-lang=bat>bcdboot C:\Windows /l zh-CN</code></pre></figure><ul><li>Change Boot Mode to Legacy.</li></ul><p>(2) Legacy + MBR =&gt; UEFI + GPT</p><ul><li>Use DiskGenius to convert.</li><li>Create two new partitions sized about 200MB and 128MB from header. The 200MB partition will be used as ESP so its filesystem must be FAT32. Alloc a drive letter (for example, X:) to the ESP.</li><li>Type these commands in Command Prompt:</li></ul><figure class=highlight><pre><code class=language-bat data-lang=bat>diskpart
list disk
sel disk 0
list part
sel part 0
set id={C12A7328-F81F-11D2-BA4B-00A0C93EC93B}
sel part 1
set id={E3C9E316-0B5C-4DB8-817D-F92DF00215AE}
quit</code></pre></figure><ul><li>Fix boot:</li></ul><figure class=highlight><pre><code class=language-bat data-lang=bat>bcdboot C:\Windows /s X: /f uefi /l zh-cn</code></pre></figure><ul><li>Change Boot Mode to UEFI.</li></ul><h2 id=notes-on-installing-windows>Notes on installing Windows</h2><ul><li>Windows 7 can be installed via EFI mode. If the installer can’t boot via EFI mode, you can find <code class=highlighter-rouge>bootmgfw.efi</code> in the existing Windows, copy it to <code class=highlighter-rouge>EFI/Boot/</code> directory and rename it to bootx64.efi.</li><li>Most Chinese won’t want to install Windows 7 via EFI mode except genuine users.</li><li>If you want to make a dual-boot, and have a Windows 8 (or newer), it’s better to disable “Quick Startup” in Power Settings in Control Panel, or partitions can’t be accessed correctly by other systems especially Linux.</li><li>If a error about GPT/MBR occurs while installing Windows, and Legacy Mode is required but the computer can’t switch boot modes, you can try to delete or rename <code class=highlighter-rouge>EFI</code> directory in your installation disk.</li></ul><h1 id=linux-support>Linux Support</h1><p>Linux supports both GPT and MBR, and supports UEFI and Legacy.</p><p>Old systems use LILO or GRUB as the bootloader. They two don’t support UEFI.</p><p>Now most distributions use GRUB2 and syslinux (in Installation CD). They support UEFI. Few distributions support Secure Boot except Ubuntu and Fedora.</p><p>Of course, 32-bit Linux don’t support UEFI as 32-bit Windows do.</p><p>If you want to switch boot mode, you just need to reinstall the bootloader rather than the whole system.</p><h1 id=os-x-support>OS X Support</h1><h2 id=mac>Mac</h2><p>All of Macs use Apple EFI. Apple computers don’t support Legacy Mode.</p><p>Apple computers use GPT and there are only three partitions: ESP, Macintosh HD (HFS+ filesystem), Recovery HD (HFS+ filesystem)/</p><p>Systems in USB drives must support EFI in order to boot in Apple computers. Press <code class=highlighter-rouge>Option</code> key after powering on, a boot menu will shown and you can choose the USB drive.</p><p>It’s recommended to use <code class=highlighter-rouge>BootCamp Assistant</code> in OS X if you want to install Windows.</p><p>If you use Windows just in few times, you can use virtual machines such as Parallels Desktop, VMware Fusion or VirtualBox.</p><h2 id=hackintosh>Hackintosh</h2><p>“Hackintosh” is OS X which installed into a normal computer rather than Apple computers.</p><p>Steps on installing Hackintosh is really complicated. I won’t introduce them.</p><p>Hackintosh can’t boot directly without a special bootloader. Currently there are two popular bootloaders - Clover and Chameleon. Chameleon only supports Legacy Mode. Clover supports both UEFI and Legacy.</p><p>OS X only supports GPT. So you must crack the kernel if you want to install it to a MBR drive. It’s not recommended to upgrade the system after cracking the kernel unless you know how to crack it again.</p></article><div class=text-right><ul class=sharelist><li><a href=# class=share data-target=weibo data-toggle=tooltip title="Share on Weibo"><i class="fa fa-weibo"></i></a></li><li><a href=# class=share data-target=linkedin data-toggle=tooltip title="Share on LinkedIn"><i class="fa fa-linkedin-square"></i></a></li><li><a href=# class=share data-target=facebook data-toggle=tooltip title="Share on Facebook"><i class="fa fa-facebook-square"></i></a></li><li><a href=# class=share data-target=twitter data-toggle=tooltip title="Share on Twitter"><i class="fa fa-twitter-square"></i></a></li><li><span class=text-muted>Share this post:</span></li></ul><script src=/static/js/share.js></script></div><br class=clear><div class="post-area post comment"><div id=disqus_thread></div><script type=text/javascript>var disqus_shortname="vjudge1";!function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="//"+disqus_shortname+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)}();</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript rel=nofollow>comments powered by Disqus.</a></noscript></div><br class=clear></div><div id=content class="col-sm-4 hidden-xs hidden-sm"></div></div></div><div id=sidebar style=display:none><h4 class="page-header text-muted"><i class="fa fa-search"></i> Search</h4><form action="/search/"><div class=form-group><input placeholder=Regexp class=form-control name=s id=keyword></div></form><h4 class="page-header text-muted"><i class="fa fa-th-list"></i> Categories</h4><div class=categories-list><a class=item href="/categories/?c=All" data-cate=All>All <span class=badge>38</span></a> <a class=item href="/categories/?c=Others" data-cate=Others>Others <span class=badge>6</span></a> <a class=item href="/categories/?c=Linux" data-cate=Linux>Linux <span class=badge>11</span></a> <a class=item href="/categories/?c=Maintainance" data-cate=Maintainance>Maintainance <span class=badge>3</span></a> <a class=item href="/categories/?c=Mac" data-cate=Mac>Mac <span class=badge>5</span></a> <a class=item href="/categories/?c=GitHub" data-cate=GitHub>GitHub <span class=badge>4</span></a> <a class=item href="/categories/?c=Arduino" data-cate=Arduino>Arduino <span class=badge>1</span></a> <a class=item href="/categories/?c=fun" data-cate=fun>fun <span class=badge>2</span></a> <a class=item href="/categories/?c=Web" data-cate=Web>Web <span class=badge>6</span></a> <a class=item href="/categories/?c=others" data-cate=others>others <span class=badge>1</span></a> <a class=item href="/categories/?c=Ruby" data-cate=Ruby>Ruby <span class=badge>1</span></a> <a class=item href="/categories/?c=Programming" data-cate=Programming>Programming <span class=badge>3</span></a> <a class=item href="/categories/?c=Fun" data-cate=Fun>Fun <span class=badge>1</span></a></div><h4 class="page-header text-muted"><i class="fa fa-tags"></i> Tags</h4><a href=/tags/#tag-Linux style=font-size:13.5pt;color:#444 data-toggle=tooltip data-placement=top title="2 articles">Linux</a>&nbsp; <a href=/tags/#tag-中文 style=font-size:9pt;color:#999 data-toggle=tooltip data-placement=top title="1 article">中文</a>&nbsp; <a href=/tags/#tag-Hackintosh style=font-size:18pt;color:#000 data-toggle=tooltip data-placement=top title="3 articles">Hackintosh</a>&nbsp; <a href=/tags/#tag-UEFI style=font-size:13.5pt;color:#444 data-toggle=tooltip data-placement=top title="2 articles">UEFI</a>&nbsp; <a href=/tags/#tag-单片机 style=font-size:9pt;color:#999 data-toggle=tooltip data-placement=top title="1 article">单片机</a>&nbsp; <a href=/tags/#tag-Jekyll style=font-size:13.5pt;color:#444 data-toggle=tooltip data-placement=top title="2 articles">Jekyll</a>&nbsp; <a href=/tags/#tag-GitHub style=font-size:18pt;color:#000 data-toggle=tooltip data-placement=top title="3 articles">GitHub</a>&nbsp; <a href=/tags/#tag-Scripting style=font-size:13.5pt;color:#444 data-toggle=tooltip data-placement=top title="2 articles">Scripting</a>&nbsp; <a href=/tags/#tag-Arduino style=font-size:9pt;color:#999 data-toggle=tooltip data-placement=top title="1 article">Arduino</a>&nbsp; <a href=/tags/#tag-Wireless style=font-size:13.5pt;color:#444 data-toggle=tooltip data-placement=top title="2 articles">Wireless</a>&nbsp; <a href=/tags/#tag-hostapd style=font-size:13.5pt;color:#444 data-toggle=tooltip data-placement=top title="2 articles">hostapd</a>&nbsp; <a href=/tags/#tag-Windows style=font-size:9pt;color:#999 data-toggle=tooltip data-placement=top title="1 article">Windows</a>&nbsp; <a href=/tags/#tag-LaTeX style=font-size:9pt;color:#999 data-toggle=tooltip data-placement=top title="1 article">LaTeX</a>&nbsp; <a href=/tags/#tag-Ubuntu style=font-size:9pt;color:#999 data-toggle=tooltip data-placement=top title="1 article">Ubuntu</a>&nbsp; <a href=/tags/#tag-教务系统 style=font-size:9pt;color:#999 data-toggle=tooltip data-placement=top title="1 article">教务系统</a>&nbsp; <a href=/tags/#tag-Mac style=font-size:9pt;color:#999 data-toggle=tooltip data-placement=top title="1 article">Mac</a>&nbsp; <a href=/tags/#tag-NTFS style=font-size:9pt;color:#999 data-toggle=tooltip data-placement=top title="1 article">NTFS</a>&nbsp; <a href=/tags/#tag-Request style=font-size:9pt;color:#999 data-toggle=tooltip data-placement=top title="1 article">Request</a>&nbsp; <a href=/tags/#tag-C style=font-size:13.5pt;color:#444 data-toggle=tooltip data-placement=top title="2 articles">C</a>&nbsp; <a href=/tags/#tag-CGI style=font-size:13.5pt;color:#444 data-toggle=tooltip data-placement=top title="2 articles">CGI</a>&nbsp; <a href=/tags/#tag-Session style=font-size:9pt;color:#999 data-toggle=tooltip data-placement=top title="1 article">Session</a>&nbsp; <a href=/tags/#tag-Synergy style=font-size:9pt;color:#999 data-toggle=tooltip data-placement=top title="1 article">Synergy</a>&nbsp; <a href=/tags/#tag-Rails style=font-size:9pt;color:#999 data-toggle=tooltip data-placement=top title="1 article">Rails</a>&nbsp; <a href=/tags/#tag-Dash style=font-size:9pt;color:#999 data-toggle=tooltip data-placement=top title="1 article">Dash</a>&nbsp; <a href=/tags/#tag-API style=font-size:9pt;color:#999 data-toggle=tooltip data-placement=top title="1 article">API</a>&nbsp; <a href=/tags/#tag-wine style=font-size:9pt;color:#999 data-toggle=tooltip data-placement=top title="1 article">wine</a>&nbsp; <a href=/tags/#tag-插件 style=font-size:18pt;color:#000 data-toggle=tooltip data-placement=top title="3 articles">插件</a>&nbsp;<h4 class="page-header text-muted"><i class="fa fa-external-link"></i> Links</h4><ul class="link-list fa-ul"><li><i class="fa-li fa fa-link"></i><a href=https://upclinux.github.io data-toggle=tooltip data-placement=bottom title=https://upclinux.github.io>UPC Linux</a></li><li><i class="fa-li fa fa-link"></i><a href=https://upclinux.github.io/intro/ data-toggle=tooltip data-placement=bottom title="https://upclinux.github.io/intro/">UPC Linux / Intro</a></li><li><i class="fa-li fa fa-link"></i><a href=http://www.lihuanyu.com data-toggle=tooltip data-placement=bottom title=http://www.lihuanyu.com>环宇的博客</a></li><li><i class="fa-li fa fa-link"></i><a href=http://wangchenyu.net.cn data-toggle=tooltip data-placement=bottom title=http://wangchenyu.net.cn>微尘风景BBS</a></li><li><i class="fa-li fa fa-link"></i><a href=http://jerry.weighingproduct.com data-toggle=tooltip data-placement=bottom title=http://jerry.weighingproduct.com>Jerry Yuan</a></li></ul></div><script type=text/javascript src=//cdnjs.cloudflare.com/ajax/libs/anchor-js/1.1.1/anchor.min.js></script><script type=text/javascript>anchors.options.placement="left",anchors.add("article h1,h2,h3,h4");</script><script type=text/javascript src=/static/js/callout.js></script><div id=top data-toggle=tooltip data-placement=left title="Back to top"><a href=javascript:;><div class=arrow></div><div class=stick></div></a></div><footer class=site-footer><div class=container><ol class=footer-list><li>&copy; 2015 vjudge1</li><li><a href="/about/">About</a></li><li><a href=mailto:vjudge404@gmail.com>Email</a></li><li><a href=https://github.com/vjudge1>GitHub</a></li><li><a href=https://twitter.com/vjudge404>Twitter</a></li><li><a href=https://www.facebook.com/vjudge404>Facebook</a></li></ol></div></footer><div style=display:none><script src="//s95.cnzz.com/z_stat.php?id=1256463916&web_id=1256463916"></script></div></body></html>