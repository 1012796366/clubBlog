<!DOCTYPE html><html><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><script type=text/javascript>var host="vjudge1.github.io";host==window.location.host&&"https:"!=window.location.protocol&&(window.location.protocol="https");</script><title>［科普］网络故障</title><meta name=description content=为什么有些网站，例如百度、新浪微博和人人网所抄袭的对象，它们明明就在那里，但是就是进不去？难道是网络故障吗？原因大家肯定都懂得其实不一定懂，因此本文将科普一些更详细的知识。><link rel=stylesheet href=/css/main.css><link rel=stylesheet type=text/css href=/css/font-awesome.min.css><link rel=canonical href=https://vjudge1.github.io/2015/09/26/g-f-w.html><link rel=alternate type=application/rss+xml title=Unorz href="https://vjudge1.github.io/feed.xml"><link type=application/atom+xml rel=alternate href=https://vjudge1.github.io/feed.xml><script type=text/javascript src=/static/js/jquery-1.11.3.min.js></script><script type=text/javascript src=/static/js/bootstrap.min.js></script><script type=text/javascript src=/static/js/index.js></script></head><body><header><nav class="navbar navbar-default"><div class=container><div class=navbar-header><button type=button class="navbar-toggle navbar-toggle-left collapsed" data-toggle=modal data-target=#nav-sidebar><span class=sr-only>Toggle navigation</span> <span class=icon-bar></span> <span class=icon-bar></span> <span class=icon-bar></span></button> <button type=button class="navbar-toggle collapsed" data-toggle=collapse data-target=#navbar aria-expanded=false aria-controls=navbar><span class=sr-only>Toggle navigation</span> <span class="fa fa-angle-double-right icon"></span></button> <a class=navbar-brand href="/"><i class="fa fa-github-alt"></i> Unorz</a></div><div id=navbar class="collapse navbar-collapse"><ul class="nav navbar-nav navbar-right"><li><a href=/ data-toggle=tooltip data-placement=bottom title=Home><i class="fa fa-home"></i></a></li><li class=dropdown><a href=# class=dropdown-toggle data-toggle=dropdown role=button aria-expanded=true data-toggle=tooltip data-placement=bottom title=Categories><i class="fa fa-th-list"></i><span class=caret></span></a><ul class=dropdown-menu role=menu><li><a href="/categories/?c=All"><span class=badge style=float:right>38</span>All</a></li><li class=divider></li><li class=dropdown-header>Lists</li><li><a href="/categories/?c=Others"><span class=badge style=float:right>6</span>Others</a></li><li><a href="/categories/?c=Linux"><span class=badge style=float:right>11</span>Linux</a></li><li><a href="/categories/?c=Maintainance"><span class=badge style=float:right>3</span>Maintainance</a></li><li><a href="/categories/?c=Mac"><span class=badge style=float:right>5</span>Mac</a></li><li><a href="/categories/?c=GitHub"><span class=badge style=float:right>4</span>GitHub</a></li><li><a href="/categories/?c=Arduino"><span class=badge style=float:right>1</span>Arduino</a></li><li><a href="/categories/?c=fun"><span class=badge style=float:right>2</span>fun</a></li><li><a href="/categories/?c=Web"><span class=badge style=float:right>6</span>Web</a></li><li><a href="/categories/?c=others"><span class=badge style=float:right>1</span>others</a></li><li><a href="/categories/?c=Ruby"><span class=badge style=float:right>1</span>Ruby</a></li><li><a href="/categories/?c=Programming"><span class=badge style=float:right>3</span>Programming</a></li><li><a href="/categories/?c=Fun"><span class=badge style=float:right>1</span>Fun</a></li></ul></li><li><a href=/tags/ data-toggle=tooltip data-placement=bottom title=Tags><i class="fa fa-tags"></i></a></li><li><a href=/about/ data-toggle=tooltip data-placement=bottom title=About><i class="fa fa-file-o"></i></a></li><li><a href=https://github.com/vjudge1/vjudge1.github.io data-toggle=tooltip data-placement=bottom title="Source Code"><i class="fa fa-code icon"></i></a></li><li><a href=/feed.xml data-toggle=tooltip data-placement=bottom title=RSS><i class="fa fa-rss icon"></i></a></li></ul><form class="navbar-form navbar-right hidden-sm hidden-md hidden-lg" action="/search/"><div class=form-group><input placeholder=Regexp class=form-control name=s id=keyword></div></form></div></div></nav></header><div class=modal id=nav-sidebar tabindex=-1 role=dialog aria-labelledby=myModalLabel aria-hidden=true><div class="modal-dialog nav-sidebar"><div class=title><a class=navbar-brand href="/">Unorz</a></div><div class=content id=nav-sidebar-content><h4 class="page-header text-muted"><i class="fa fa-search"></i> Search</h4><form action="/search/"><div class=form-group><input placeholder=Regexp class=form-control name=s id=keyword></div></form><h4 class="page-header text-muted"><i class="fa fa-th-list"></i> Categories</h4><div class=categories-list><a class=item href="/categories/?c=All" data-cate=All>All <span class=badge>38</span></a> <a class=item href="/categories/?c=Others" data-cate=Others>Others <span class=badge>6</span></a> <a class=item href="/categories/?c=Linux" data-cate=Linux>Linux <span class=badge>11</span></a> <a class=item href="/categories/?c=Maintainance" data-cate=Maintainance>Maintainance <span class=badge>3</span></a> <a class=item href="/categories/?c=Mac" data-cate=Mac>Mac <span class=badge>5</span></a> <a class=item href="/categories/?c=GitHub" data-cate=GitHub>GitHub <span class=badge>4</span></a> <a class=item href="/categories/?c=Arduino" data-cate=Arduino>Arduino <span class=badge>1</span></a> <a class=item href="/categories/?c=fun" data-cate=fun>fun <span class=badge>2</span></a> <a class=item href="/categories/?c=Web" data-cate=Web>Web <span class=badge>6</span></a> <a class=item href="/categories/?c=others" data-cate=others>others <span class=badge>1</span></a> <a class=item href="/categories/?c=Ruby" data-cate=Ruby>Ruby <span class=badge>1</span></a> <a class=item href="/categories/?c=Programming" data-cate=Programming>Programming <span class=badge>3</span></a> <a class=item href="/categories/?c=Fun" data-cate=Fun>Fun <span class=badge>1</span></a></div><h4 class="page-header text-muted"><i class="fa fa-tags"></i> Tags</h4><a href=/tags/#tag-Linux style=font-size:13.5pt;color:#444 data-toggle=tooltip data-placement=top title="2 articles">Linux</a>&nbsp; <a href=/tags/#tag-中文 style=font-size:9pt;color:#999 data-toggle=tooltip data-placement=top title="1 article">中文</a>&nbsp; <a href=/tags/#tag-Hackintosh style=font-size:18pt;color:#000 data-toggle=tooltip data-placement=top title="3 articles">Hackintosh</a>&nbsp; <a href=/tags/#tag-UEFI style=font-size:13.5pt;color:#444 data-toggle=tooltip data-placement=top title="2 articles">UEFI</a>&nbsp; <a href=/tags/#tag-单片机 style=font-size:9pt;color:#999 data-toggle=tooltip data-placement=top title="1 article">单片机</a>&nbsp; <a href=/tags/#tag-Jekyll style=font-size:13.5pt;color:#444 data-toggle=tooltip data-placement=top title="2 articles">Jekyll</a>&nbsp; <a href=/tags/#tag-GitHub style=font-size:18pt;color:#000 data-toggle=tooltip data-placement=top title="3 articles">GitHub</a>&nbsp; <a href=/tags/#tag-Scripting style=font-size:13.5pt;color:#444 data-toggle=tooltip data-placement=top title="2 articles">Scripting</a>&nbsp; <a href=/tags/#tag-Arduino style=font-size:9pt;color:#999 data-toggle=tooltip data-placement=top title="1 article">Arduino</a>&nbsp; <a href=/tags/#tag-Wireless style=font-size:13.5pt;color:#444 data-toggle=tooltip data-placement=top title="2 articles">Wireless</a>&nbsp; <a href=/tags/#tag-hostapd style=font-size:13.5pt;color:#444 data-toggle=tooltip data-placement=top title="2 articles">hostapd</a>&nbsp; <a href=/tags/#tag-Windows style=font-size:9pt;color:#999 data-toggle=tooltip data-placement=top title="1 article">Windows</a>&nbsp; <a href=/tags/#tag-LaTeX style=font-size:9pt;color:#999 data-toggle=tooltip data-placement=top title="1 article">LaTeX</a>&nbsp; <a href=/tags/#tag-Ubuntu style=font-size:9pt;color:#999 data-toggle=tooltip data-placement=top title="1 article">Ubuntu</a>&nbsp; <a href=/tags/#tag-教务系统 style=font-size:9pt;color:#999 data-toggle=tooltip data-placement=top title="1 article">教务系统</a>&nbsp; <a href=/tags/#tag-Mac style=font-size:9pt;color:#999 data-toggle=tooltip data-placement=top title="1 article">Mac</a>&nbsp; <a href=/tags/#tag-NTFS style=font-size:9pt;color:#999 data-toggle=tooltip data-placement=top title="1 article">NTFS</a>&nbsp; <a href=/tags/#tag-Request style=font-size:9pt;color:#999 data-toggle=tooltip data-placement=top title="1 article">Request</a>&nbsp; <a href=/tags/#tag-C style=font-size:13.5pt;color:#444 data-toggle=tooltip data-placement=top title="2 articles">C</a>&nbsp; <a href=/tags/#tag-CGI style=font-size:13.5pt;color:#444 data-toggle=tooltip data-placement=top title="2 articles">CGI</a>&nbsp; <a href=/tags/#tag-Session style=font-size:9pt;color:#999 data-toggle=tooltip data-placement=top title="1 article">Session</a>&nbsp; <a href=/tags/#tag-Synergy style=font-size:9pt;color:#999 data-toggle=tooltip data-placement=top title="1 article">Synergy</a>&nbsp; <a href=/tags/#tag-Rails style=font-size:9pt;color:#999 data-toggle=tooltip data-placement=top title="1 article">Rails</a>&nbsp; <a href=/tags/#tag-Dash style=font-size:9pt;color:#999 data-toggle=tooltip data-placement=top title="1 article">Dash</a>&nbsp; <a href=/tags/#tag-API style=font-size:9pt;color:#999 data-toggle=tooltip data-placement=top title="1 article">API</a>&nbsp; <a href=/tags/#tag-wine style=font-size:9pt;color:#999 data-toggle=tooltip data-placement=top title="1 article">wine</a>&nbsp; <a href=/tags/#tag-插件 style=font-size:18pt;color:#000 data-toggle=tooltip data-placement=top title="3 articles">插件</a>&nbsp;<h4 class="page-header text-muted"><i class="fa fa-external-link"></i> Links</h4><ul class="link-list fa-ul"><li><i class="fa-li fa fa-link"></i><a href=https://upclinux.github.io data-toggle=tooltip data-placement=bottom title=https://upclinux.github.io>UPC Linux</a></li><li><i class="fa-li fa fa-link"></i><a href=https://upclinux.github.io/intro/ data-toggle=tooltip data-placement=bottom title="https://upclinux.github.io/intro/">UPC Linux / Intro</a></li><li><i class="fa-li fa fa-link"></i><a href=http://www.lihuanyu.com data-toggle=tooltip data-placement=bottom title=http://www.lihuanyu.com>环宇的博客</a></li><li><i class="fa-li fa fa-link"></i><a href=http://wangchenyu.net.cn data-toggle=tooltip data-placement=bottom title=http://wangchenyu.net.cn>微尘风景BBS</a></li><li><i class="fa-li fa fa-link"></i><a href=http://jerry.weighingproduct.com data-toggle=tooltip data-placement=bottom title=http://jerry.weighingproduct.com>Jerry Yuan</a></li></ul></div></div></div><div class=jumbotron><div class=container><h1 class=post-title id=post-title><a href="/">［科普］网络故障</a></h1><p><span class="glyphicon glyphicon-calendar"></span> Sep 26, 2015 &nbsp;&nbsp;&nbsp;<span class="glyphicon glyphicon-user"></span> vjudge1 &nbsp;&nbsp;&nbsp;<span class="glyphicon glyphicon-th-list"></span> <a href="/categories/?c=Web">Web</a></p></div></div><div id=main class="container main"><div class=row><div class=col-md-8 role=main><article class=article><ul id=markdown-toc><li><a href=#section id=markdown-toc-section>备注</a></li><li><a href=#section-1 id=markdown-toc-section-1>网络故障的原因</a><ul><li><a href=#section-2 id=markdown-toc-section-2>如果一切正常</a></li><li><a href=#dns-poisoning id=markdown-toc-dns-poisoning>第一种故障 (DNS poisoning)</a></li><li><a href=#ip-block id=markdown-toc-ip-block>第二种故障 (IP block)</a></li><li><a href=#keyword-filter id=markdown-toc-keyword-filter>第三种故障 (Keyword filter)</a></li><li><a href=#section-3 id=markdown-toc-section-3>其他影响</a></li></ul></li><li><a href=#section-4 id=markdown-toc-section-4>解决故障的思路</a><ul><li><a href=#https id=markdown-toc-https>HTTPS</a></li><li><a href=#ipv6 id=markdown-toc-ipv6>IPv6</a></li><li><a href=#section-5 id=markdown-toc-section-5>鸡毛信</a></li></ul></li><li><a href=#section-6 id=markdown-toc-section-6>规避风险</a><ul><li><a href=#protocol-detecting id=markdown-toc-protocol-detecting>Protocol detecting</a></li><li><a href=#section-7 id=markdown-toc-section-7>探测</a></li><li><a href=#section-8 id=markdown-toc-section-8>办假证</a></li></ul></li><li><a href=#section-9 id=markdown-toc-section-9>不为人知的事情</a></li><li><a href=#section-10 id=markdown-toc-section-10>其他</a></li></ul><p>为什么有些网站，例如百度、新浪微博和人人网<span class=blackout>所抄袭的对象</span>，它们明明就在那里，但是就是进不去？</p><p>难道是网络故障吗？原因大家<s>肯定都懂得</s>其实不一定懂，因此本文将科普一些更详细的知识。</p><h1 id=section>备注</h1><p>为了方便叙述，后文将把那个你懂得的东西叫做<s>墙</s>出口检测设备。</p><p>国内的网络连接不经过这个设备，只有出国或者回国的时候才会经过这个设备。在国内根本不需要类似的设备<span class=blackout>只需要一些叔叔就能彻底解决问题了</span>。</p><p>“出口检测设备”大约于 1998 年成立，作者是大名鼎鼎的方<span class=blackout>滨兴</span>校长。</p><p>那么设备由谁主管呢？这个没有人知道，但是他不告诉我们到底是谁。我猜这个人应该姓阎<span class=blackout>，因为我们曾经派了一些人去打听相关的事儿，但是他们都从来没有回来过</span>。</p><h1 id=section-1>网络故障的原因</h1><p>回到正题，为什么有些网站进不去？原因有很多种，本文将一一介绍。</p><h2 id=section-2>如果一切正常</h2><p>当我们要去一个地方的时候，例如北京邮电大学<small>（相当于“域名”）</small>，我们当然需要知道地址，或者知道“怎么走”<small>（也就是“路由”）</small>才能过去。</p><p>[% callout %] 北京邮电大学</p><p>北京邮电大学那么小，小到不比你的高中校园大多少的程度，为什么还要拿它举例子呢？因为它是革命圣地——出口检测设备的诞生地！ [% endcallout %]</p><p>当我们第一次去北京的时候，我们当然需要问路<small>（“DNS 查询”）</small>。问路的目标有很多——你可以问&lt;img class=’emoji’ title=’<img class=emoji title=:cop: alt=:cop: src=https://assets.github.com/images/icons/emoji/unicode/1f46e.png height=20 width=20 align="absmiddle">’ alt=’<img class=emoji title=:cop: alt=:cop: src=https://assets.github.com/images/icons/emoji/unicode/1f46e.png height=20 width=20 align="absmiddle">’ src=’https://assets.github.com/images/icons/emoji/unicode/1f46e.png’ height=’20’ width=’20’ align=’absmiddle’ /&gt;叔叔，也可以问路边开小卖店的，当然也可以直接给北京邮电大学打电话。这些不同的人，就相当于不同的 DNS 服务器。<small>（因此有的时候能登上 QQ 但是打不开网页，就是因为你想找叔叔问路但是周围没有叔叔，所以你当然要换个人来问——换 DNS 服务器。）</small></p><p>如果&lt;img class=’emoji’ title=’<img class=emoji title=:cop: alt=:cop: src=https://assets.github.com/images/icons/emoji/unicode/1f46e.png height=20 width=20 align="absmiddle">’ alt=’<img class=emoji title=:cop: alt=:cop: src=https://assets.github.com/images/icons/emoji/unicode/1f46e.png height=20 width=20 align="absmiddle">’ src=’https://assets.github.com/images/icons/emoji/unicode/1f46e.png’ height=’20’ width=’20’ align=’absmiddle’ /&gt;叔叔或者什么人知道北京邮电大学在哪儿，他就会回答你，并且告诉你北京邮电大学在“北京市海淀区西土城路 10 号”<small>（正确的 IP 地址）</small>。</p><p>当然找的时候就是“从北京站乘坐地铁 2 号线，到达车公庄站，从地铁东南口出，步行约160米，到达车公庄北站，乘坐 632 到达明光桥北站，向北步行即可到达北京邮电大学西门”<small>（路由）</small>。因为地址是正确的，所以只要按照这条路线走，就肯定能找到北京邮电大学。</p><h2 id=dns-poisoning>第一种故障 (DNS poisoning)</h2><p>事实上，有些北京人比较排外<span class=blackout>或者他们是已经知道你的底细的北京朝阳群众</span>，尤其排斥东北人，觉得你不应该去北京邮电大学<span class=blackout>打出口检测设备的主意</span>，所以，当你问路的时候会告诉你一个错误的地方，例如“北京市顺化区长青路45号”<small>（很明显是一个根本不存在的 IP 地址）</small>。近些年来，他们也会告诉你一个貌似正确，实际上并不正确的地方，如“北京市昌平区府学路27号”<small>（中国政法大学——错误但确实存在的 IP 地址）</small>。</p><p>很多网站上不去，原因就是这么&lt;img class=’emoji’ title=’<img class=emoji title=:hankey: alt=:hankey: src=https://assets.github.com/images/icons/emoji/unicode/1f4a9.png height=20 width=20 align="absmiddle">’ alt=’<img class=emoji title=:hankey: alt=:hankey: src=https://assets.github.com/images/icons/emoji/unicode/1f4a9.png height=20 width=20 align="absmiddle">’ src=’https://assets.github.com/images/icons/emoji/unicode/1f4a9.png’ height=’20’ width=’20’ align=’absmiddle’ /&gt;简单。</p><p><img src=/img/2015-09-26-gfw2/dnspoisoning.jpg alt="dns"><br><small>别有用心的路牌——就是这个意思</small></p><p>那么，直接给北邮打电话<small>（把 DNS 服务器设置成国外的）</small>不就可以知道准确的地址了吗？但是很遗憾，出口检测设备的技术已经高到可以直接换地址的程度了——北邮的工作人员告诉你是“海淀区”，但是你接电话的时候听到的仍然是“昌平区”。</p><p>因此有些网站需要自己找到正确的地址才能访问。</p><p>[% callout %] 判断方法</p><p>可以使用 nslookup 命令查询和判断是否有人误导你，给你指出了错误的路，例如</p><div class=highlighter-rouge><pre class=highlight><code>nslookup www.baidu.com
</code></pre></div><p>如果想测试其他 DNS 服务器，使用</p><div class=highlighter-rouge><pre class=highlight><code>nslookup www.baidu.com 114.114.114.114
</code></pre></div><p>将得到的 IP 结果到百度上查一查，看看到底是否靠谱。一般情况下，只要那个网站上不去，基本上 IP 都是不靠谱的。 [% endcallout %]</p><p>[% callout %] 怎样才能找到呢？</p><p>在线 nslookup 网站（online nslookup）那么多，为什么不找一个靠谱的查一查呢？</p><p>查完记得 Ping 一下，因为…… [% endcallout %]</p><h2 id=ip-block>第二种故障 (IP block)</h2><p>毕竟问路效果有限<small>（如果自己知道地址就可以自己去找了）</small>，所以为了取得更好的效果，可以直接把路拆了。这种事儿铁道游击队做得太多了。</p><p>所以，只要把通向北邮的道路全部拆掉<small>（IP block）</small>，即使你知道北邮在哪儿你照样过不去。</p><p><img src=/img/2015-09-26-gfw2/ipblock.jpg alt="ip"><br><small>百度就在路的那面，有本事过去啊</small></p><p>[% callout %] 判断方法</p><p>很简单，ping 一下就知道有没有路了。</p><div class=highlighter-rouge><pre class=highlight><code>ping 192.168.1.1
</code></pre></div><p>如果想知道详情，可使用 traceroute（tracert）命令。 [% endcallout %]</p><p>有的时候，路并没有完全拆毁，只是不太好走而已。</p><h2 id=keyword-filter>第三种故障 (Keyword filter)</h2><p>还记得多少年前用百度<span class=blackout>所抄袭的那个网站</span>搜索一点东西，搜着搜着就“连接已<s>重置</s>充值”了吧？</p><p>普通的网页传输采用 HTTP 协议。这就好比上街的时候不拿兜子或背包，直接拿着东西走——你拿了什么，路人<span class=blackout>和朝阳群众</span>一目了然。</p><p>[% callout %] 明文传输</p><p>在网页里输入密码，密码看不见，对吧？提交表单，提交内容看不见，对吧？在此必须要提醒你，其实挡上了也是明文——防君子不防小人而已。</p><p>当然，HTTP 也没危险到任何人都能截获，要不然人们就不会用这个协议了。但是，如果一个别有用心的人在你的网络访问的路上设了关卡，例如钓鱼热点，那么你的安全将不复存在，因为明文传输意味着他可以看得清清楚楚。就像下图一样：</p><p><img src=/img/2015-09-26-gfw2/http.png alt="http"> [% endcallout %]</p><p>2002 年诞生了一项新技术<span class=blackout>北京朝阳群众技术</span>：</p><p>如果你拿的是正常的东西，那么在大街上走路的时候当然不会有问题。但是，如果你拿了一些不该拿的东西，例如&lt;img class=’emoji’ title=’<img class=emoji title=:bomb: alt=:bomb: src=https://assets.github.com/images/icons/emoji/unicode/1f4a3.png height=20 width=20 align="absmiddle">’ alt=’<img class=emoji title=:bomb: alt=:bomb: src=https://assets.github.com/images/icons/emoji/unicode/1f4a3.png height=20 width=20 align="absmiddle">’ src=’https://assets.github.com/images/icons/emoji/unicode/1f4a3.png’ height=’20’ width=’20’ align=’absmiddle’ /&gt;或者一本封面上阿姨没穿衣服的书<small>（传输过程中出现关键词）</small>，那么有人<span class=blackout>朝阳群众</span>自然有事情做了——请&lt;img class=’emoji’ title=’<img class=emoji title=:cop: alt=:cop: src=https://assets.github.com/images/icons/emoji/unicode/1f46e.png height=20 width=20 align="absmiddle">’ alt=’<img class=emoji title=:cop: alt=:cop: src=https://assets.github.com/images/icons/emoji/unicode/1f46e.png height=20 width=20 align="absmiddle">’ src=’https://assets.github.com/images/icons/emoji/unicode/1f46e.png’ height=’20’ width=’20’ align=’absmiddle’ /&gt;叔叔来找你<small>（触发关键词，连接中断）</small>。</p><p><img src=/img/2015-09-26-gfw2/telescreen.jpg alt="telescreen"><br><small>一点遮挡都没有，老大哥当然可以看得清清楚楚</small></p><p>需要注意的是，即使你找到了正确的路，但是你穿着印有星星月亮<span class=blackout>恐怖组织标志</span>和一些虫子&lt;img class=’emoji’ title=’<img class=emoji title=:bug: alt=:bug: src=https://assets.github.com/images/icons/emoji/unicode/1f41b.png height=20 width=20 align="absmiddle">’ alt=’<img class=emoji title=:bug: alt=:bug: src=https://assets.github.com/images/icons/emoji/unicode/1f41b.png height=20 width=20 align="absmiddle">’ src=’https://assets.github.com/images/icons/emoji/unicode/1f41b.png’ height=’20’ width=’20’ align=’absmiddle’ /&gt;<span class=blackout>阿拉伯文</span>的衣服到处乱转，&lt;img class=’emoji’ title=’<img class=emoji title=:cop: alt=:cop: src=https://assets.github.com/images/icons/emoji/unicode/1f46e.png height=20 width=20 align="absmiddle">’ alt=’<img class=emoji title=:cop: alt=:cop: src=https://assets.github.com/images/icons/emoji/unicode/1f46e.png height=20 width=20 align="absmiddle">’ src=’https://assets.github.com/images/icons/emoji/unicode/1f46e.png’ height=’20’ width=’20’ align=’absmiddle’ /&gt;叔叔当然会找你&lt;img class=’emoji’ title=’<img class=emoji title=:new_moon_with_face: alt=:new_moon_with_face: src=https://assets.github.com/images/icons/emoji/unicode/1f31a.png height=20 width=20 align="absmiddle">’ alt=’<img class=emoji title=:new_moon_with_face: alt=:new_moon_with_face: src=https://assets.github.com/images/icons/emoji/unicode/1f31a.png height=20 width=20 align="absmiddle">’ src=’https://assets.github.com/images/icons/emoji/unicode/1f31a.png’ height=’20’ width=’20’ align=’absmiddle’ /&gt;。<small>（即 IP 正确，但是因为 HTTP 协议中的“Host: ?????.com”是明文，所以同样触发了关键词。）</small></p><p><img src=/img/2015-09-26-gfw2/terrorist.jpg alt="terrorist"><br><small>暴露了自己的恐怖分子的身份，那么随便几个群众都能把你制服</small></p><p>好在目前 HTTPS 协议不受此影响<small>（上街的时候把东西放背包里，谁知道你拿了什么？）</small>因此对于采用 HTTPS 的网站，出口检测设备需要采取其他手段。</p><p>[% callout %] 安全建议</p><p>尽量不要连接公共 Wifi。如果必须要用，建议用 VPN（仅仅是为了加密连接，不要想太多）。因为即使你可以保证只用 HTTPS，但是你要访问的网站和你所用的软件不能。 [% endcallout %]</p><h2 id=section-3>其他影响</h2><p>凡是出国途中遇到问题，都是上面提到的原因——</p><ol><li>有些时候苹果 App Store 或者 Windows 应用商店会经常出现故障。</li><li>很多外国网页加载速度奇慢无比，因为负责网页样式的代码都被放到那些“看起来不存在”的地方里面了。所以，在网页卡着的时候，浏览器事实上已经知道该输出什么文字，只不过不知道应该以什么颜色、样式输出<span class=blackout>浏览器哪儿知道什么出口检测设备</span>，所以当然是一片空白（或者是一堆没有样式的文字）。</li></ol><h1 id=section-4>解决故障的思路</h1><p>其实大家最关心的是，怎样才能解决网络故障。下面是一点点提示：</p><h2 id=https>HTTPS</h2><p>感谢爱德华·斯诺登，他让我们在解决某些问题方面变得更加轻松——2014 年，国外很多主要网站已经全面采用 HTTPS。国内有一部分网站也采用了 HTTPS。</p><p>国内为什么不普及呢？估计有两个原因：一是证书太贵了，二是太麻烦而且还没有用<span class=blackout>反正一切都是国家的</span>。</p><p>HTTPS 有什么好处呢？接着前面的例子讲——</p><p>我们说，采用 HTTP 传输就好比上大街直接拿着东西走，所以拿着什么别人看得清清楚楚。</p><p>HTTPS 就相当于上街时背个包，把东西放包里面（加密）。怎么装的只有双方知道，所以路人<span class=blackout>包括朝阳群众</span>当然不知道你带了什么东西，也管不了你。</p><p><img src=/img/2015-09-26-gfw2/87f159bf-d869-4345-9f31-0553e80b65f2.jpg alt="a"><br><small>我什么都不知道<span class=blackout>。谁知道包里面是不是炸弹呢</span>——这就是 HTTPS<a href=http://epaper.cqcb.com/html/2014-07/04/content_121984.htm>（图片来源）</a></small></p><p>自从 HTTPS 大规模普及，事实上已经成为了一个解决网络故障的原理。</p><h2 id=ipv6>IPv6</h2><p>由于 IPv6 是一个全新的协议，所以出口检测设备拿它也没办法。没准 IPv6 就是这个原因才没有被大规模推广。</p><p>但是，注意，这不代表使用 IPv6 就可以万事大吉了——因为访问 IPv6 网站也要像前文提到的那样去“问路”，所以得到的结果照样有可能是错的。</p><p>你仍然需要知道网站的正确地址才能访问。这样的话，如果 IPv4 地址是可以使用的，IPv4 和 IPv6 就没有太大区别了。不过 IPv6 速度更快而且不受干扰。</p><p>[% callout style=warning %] IPv6 隧道</p><p>IPv6 没问题对吧？但是隧道可不是——隧道是不加密的，该断当然就断了。所以不要拿隧道当梯子使！ [% endcallout %]</p><p>[% callout %] 4+6=2</p><p>知道那个可以用来屏蔽广告<span class=blackout>其实是用来出国</span>的 Hosts 吧？其实，你可以同时给一个域名指定多个 IP——既有 IPv4 又有 IPv6！ [% endcallout %]</p><h2 id=section-5>鸡毛信</h2><p>这是一个重点。</p><p>知道鸡毛信的故事吧？在抗战时期，我们当然会用一些暗语来与自己人交流，尤其是地下工作者，要不然……采用类似的方法，即使见到鬼子面了，情报也不会被鬼子<span class=blackout>直接</span>截获。</p><p><img src=/img/2015-09-26-gfw2/encrypt.jpg alt="a"><br><small>太君只能看到一群羊——谁知道羊身上还藏着情报</small></p><p>VPN、G<span class=blackout>oAgen</span>t、S<span class=blackout>hadowsSoc</span>ks<span class=blackout>、目油们</span>等都是这样的东西<span class=blackout>，只不过 VPN 只要能和有关部门合作就合法，而其他的都不合法</span>。</p><p>我们建议，如果你真的是为了学术用途，建议你花钱买个合法的 VPN<span class=blackout>，因为合法的 VPN 不会被++但是会记录你的浏览记录</span>。又稳定又方便。</p><h1 id=section-6>规避风险</h1><p>知道如何解决网络故障，但是也需要知道怎样规避风险。</p><h2 id=protocol-detecting>Protocol detecting</h2><p>智能家居从墙开始——</p><p>有了机器学习技术作为支撑，出口检测设备已经能够识别各种 VPN、Gt、Sks 等流量。至于会不会++那些流量，全凭设备的心情<span class=blackout>，可能是有一个阈值，只要流量足够大就切断</span>。</p><p><small>鸡毛信送多了，鬼子当然知道羊是用来送信的了，只不过，想不想“三光”全凭心情。</small></p><h2 id=section-7>探测</h2><p>你以为墙只是一种用来支撑房子的东西吗？那是因为你没看过正大综艺《墙来了》！</p><p>《墙来了》里的墙就可以主动地找你。可能出口检测设备就是受了 <s>CCAV</s>CCTV 的启发，也开发了主动找你的功能。</p><p>有关事项 Tor 项目已经做了深入研究，我们就不研究了。</p><h2 id=section-8>办假证</h2><p>见过路边“办证”的小广告吧？</p><p>别以为小广告都是骗人的——出口检测设备也找过这些办证的<span class=blackout>，要不然为什么总有人想着要删除 CNNIC CA 呢</span>。</p><p>因此，在访问网站时，如果浏览器提示“证书无效”，那么你一定要停下来，不要再继续，因为假证可以用来监听和干预！</p><p>[% callout %] 12306 除外</p><p>12306 的证书是自己给自己颁发的，所以当然是假证了。自己制作证书，省钱啊&lt;img class=’emoji’ title=’<img class=emoji title=:wink: alt=:wink: src=https://assets.github.com/images/icons/emoji/unicode/1f609.png height=20 width=20 align="absmiddle">’ alt=’<img class=emoji title=:wink: alt=:wink: src=https://assets.github.com/images/icons/emoji/unicode/1f609.png height=20 width=20 align="absmiddle">’ src=’https://assets.github.com/images/icons/emoji/unicode/1f609.png’ height=’20’ width=’20’ align=’absmiddle’ /&gt;！ [% endcallout %]</p><p><img src=/img/2015-09-26-gfw2/fakecert1.png alt="a"><br><small>千万不要继续，更不要信任假证书！</small></p><p><img src=/img/2015-09-26-gfw2/fakecert2.png alt="a"><br><small>因为一旦继续，老大哥就可以知道你在看什么了（没有证书就看不到）</small></p><p><img src=/img/2015-09-26-gfw2/fakecert3.png alt="a"><br><small>甚至对你恶搞一下</small></p><p>[% callout %] 关于 CNNIC</p><p>因为 CNNIC 黑历史比较多<span class=blackout>，没准 CNNIC 和某些设备是一伙儿的</span>，所以大家都不太相信他们。2015 年 3 月，CNNIC 的一个在埃及的中间证书颁发机构伪造了 G<span class=blackout>mail</span> 的证书，结果很快 Chrome、Firefox、Apple 等就不再信任 CNNIC CA 了。 [% endcallout %]</p><h1 id=section-9>不为人知的事情</h1><p>很多人以为出口检测设备只是一个检测设备，其实它还是一个非常先进的武器，俗称“大炮”。</p><p>因为中国除了人多就是人多，所以，只要随便找个大流量网站（比如 <s>12306</s>百度统计），稍微加点攻击的代码，那么——绝对是难以招架的 DDoS&lt;img class=’emoji’ title=’<img class=emoji title=:scream: alt=:scream: src=https://assets.github.com/images/icons/emoji/unicode/1f631.png height=20 width=20 align="absmiddle">’ alt=’<img class=emoji title=:scream: alt=:scream: src=https://assets.github.com/images/icons/emoji/unicode/1f631.png height=20 width=20 align="absmiddle">’ src=’https://assets.github.com/images/icons/emoji/unicode/1f631.png’ height=’20’ width=’20’ align=’absmiddle’ /&gt;！</p><p>[% callout %] 所以说……</p><p>以后想摧毁哪个反<span class=blackout>共</span>华组织的网站，只要在春节之前往 12306 网站里加入攻击代码……春节快乐！ [% endcallout %]</p><p>由于潜力巨大，2015 年 3 月末，设备首次对 GitHub 小试牛刀。这次试验取得了<span class=blackout>白白激怒了全世界软件开发人员，没有任何</span>实际效果。</p><p>[% callout %] 补充说明</p><p>由于对百度代码的修改作用发生在出口检测设备上面，因此国内访问百度并不会产生类似的攻击效果。在 GitHub 遭攻击之后不久，百度所有产品差不多都采用了 HTTPS<span class=blackout>，这样百度就不会再次被当作武器来使用了</span>。 [% endcallout %]</p><h1 id=section-10>其他</h1><p>以下方法从技术上讲都是可以实现的<span class=blackout>，有些是出口检测设备曾经用过的</span>，只不过现在设备没大规模使用而已。</p><ol><li>不是彻底把路弄断，而是隔几分钟就开一下，给人一种不稳定的感觉。</li><li>禁止发邮件。</li><li>直接切断连接。</li><li>发现指定证书后切断连接。（因为公钥未加密）</li><li>切断指定端口，如 22、443……</li></ol></article><div class=text-right><ul class=sharelist><li><a href=# class=share data-target=weibo data-toggle=tooltip title="Share on Weibo"><i class="fa fa-weibo"></i></a></li><li><a href=# class=share data-target=linkedin data-toggle=tooltip title="Share on LinkedIn"><i class="fa fa-linkedin-square"></i></a></li><li><a href=# class=share data-target=facebook data-toggle=tooltip title="Share on Facebook"><i class="fa fa-facebook-square"></i></a></li><li><a href=# class=share data-target=twitter data-toggle=tooltip title="Share on Twitter"><i class="fa fa-twitter-square"></i></a></li><li><span class=text-muted>Share this post:</span></li></ul><script src=/static/js/share.js></script></div><br class=clear><div class="post-area post comment"><div id=disqus_thread></div><script type=text/javascript>var disqus_shortname="vjudge1";!function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="//"+disqus_shortname+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)}();</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript rel=nofollow>comments powered by Disqus.</a></noscript></div><br class=clear></div><div id=content class="col-sm-4 hidden-xs hidden-sm"></div></div></div><div id=sidebar style=display:none><h4 class="page-header text-muted"><i class="fa fa-search"></i> Search</h4><form action="/search/"><div class=form-group><input placeholder=Regexp class=form-control name=s id=keyword></div></form><h4 class="page-header text-muted"><i class="fa fa-th-list"></i> Categories</h4><div class=categories-list><a class=item href="/categories/?c=All" data-cate=All>All <span class=badge>38</span></a> <a class=item href="/categories/?c=Others" data-cate=Others>Others <span class=badge>6</span></a> <a class=item href="/categories/?c=Linux" data-cate=Linux>Linux <span class=badge>11</span></a> <a class=item href="/categories/?c=Maintainance" data-cate=Maintainance>Maintainance <span class=badge>3</span></a> <a class=item href="/categories/?c=Mac" data-cate=Mac>Mac <span class=badge>5</span></a> <a class=item href="/categories/?c=GitHub" data-cate=GitHub>GitHub <span class=badge>4</span></a> <a class=item href="/categories/?c=Arduino" data-cate=Arduino>Arduino <span class=badge>1</span></a> <a class=item href="/categories/?c=fun" data-cate=fun>fun <span class=badge>2</span></a> <a class=item href="/categories/?c=Web" data-cate=Web>Web <span class=badge>6</span></a> <a class=item href="/categories/?c=others" data-cate=others>others <span class=badge>1</span></a> <a class=item href="/categories/?c=Ruby" data-cate=Ruby>Ruby <span class=badge>1</span></a> <a class=item href="/categories/?c=Programming" data-cate=Programming>Programming <span class=badge>3</span></a> <a class=item href="/categories/?c=Fun" data-cate=Fun>Fun <span class=badge>1</span></a></div><h4 class="page-header text-muted"><i class="fa fa-tags"></i> Tags</h4><a href=/tags/#tag-Linux style=font-size:13.5pt;color:#444 data-toggle=tooltip data-placement=top title="2 articles">Linux</a>&nbsp; <a href=/tags/#tag-中文 style=font-size:9pt;color:#999 data-toggle=tooltip data-placement=top title="1 article">中文</a>&nbsp; <a href=/tags/#tag-Hackintosh style=font-size:18pt;color:#000 data-toggle=tooltip data-placement=top title="3 articles">Hackintosh</a>&nbsp; <a href=/tags/#tag-UEFI style=font-size:13.5pt;color:#444 data-toggle=tooltip data-placement=top title="2 articles">UEFI</a>&nbsp; <a href=/tags/#tag-单片机 style=font-size:9pt;color:#999 data-toggle=tooltip data-placement=top title="1 article">单片机</a>&nbsp; <a href=/tags/#tag-Jekyll style=font-size:13.5pt;color:#444 data-toggle=tooltip data-placement=top title="2 articles">Jekyll</a>&nbsp; <a href=/tags/#tag-GitHub style=font-size:18pt;color:#000 data-toggle=tooltip data-placement=top title="3 articles">GitHub</a>&nbsp; <a href=/tags/#tag-Scripting style=font-size:13.5pt;color:#444 data-toggle=tooltip data-placement=top title="2 articles">Scripting</a>&nbsp; <a href=/tags/#tag-Arduino style=font-size:9pt;color:#999 data-toggle=tooltip data-placement=top title="1 article">Arduino</a>&nbsp; <a href=/tags/#tag-Wireless style=font-size:13.5pt;color:#444 data-toggle=tooltip data-placement=top title="2 articles">Wireless</a>&nbsp; <a href=/tags/#tag-hostapd style=font-size:13.5pt;color:#444 data-toggle=tooltip data-placement=top title="2 articles">hostapd</a>&nbsp; <a href=/tags/#tag-Windows style=font-size:9pt;color:#999 data-toggle=tooltip data-placement=top title="1 article">Windows</a>&nbsp; <a href=/tags/#tag-LaTeX style=font-size:9pt;color:#999 data-toggle=tooltip data-placement=top title="1 article">LaTeX</a>&nbsp; <a href=/tags/#tag-Ubuntu style=font-size:9pt;color:#999 data-toggle=tooltip data-placement=top title="1 article">Ubuntu</a>&nbsp; <a href=/tags/#tag-教务系统 style=font-size:9pt;color:#999 data-toggle=tooltip data-placement=top title="1 article">教务系统</a>&nbsp; <a href=/tags/#tag-Mac style=font-size:9pt;color:#999 data-toggle=tooltip data-placement=top title="1 article">Mac</a>&nbsp; <a href=/tags/#tag-NTFS style=font-size:9pt;color:#999 data-toggle=tooltip data-placement=top title="1 article">NTFS</a>&nbsp; <a href=/tags/#tag-Request style=font-size:9pt;color:#999 data-toggle=tooltip data-placement=top title="1 article">Request</a>&nbsp; <a href=/tags/#tag-C style=font-size:13.5pt;color:#444 data-toggle=tooltip data-placement=top title="2 articles">C</a>&nbsp; <a href=/tags/#tag-CGI style=font-size:13.5pt;color:#444 data-toggle=tooltip data-placement=top title="2 articles">CGI</a>&nbsp; <a href=/tags/#tag-Session style=font-size:9pt;color:#999 data-toggle=tooltip data-placement=top title="1 article">Session</a>&nbsp; <a href=/tags/#tag-Synergy style=font-size:9pt;color:#999 data-toggle=tooltip data-placement=top title="1 article">Synergy</a>&nbsp; <a href=/tags/#tag-Rails style=font-size:9pt;color:#999 data-toggle=tooltip data-placement=top title="1 article">Rails</a>&nbsp; <a href=/tags/#tag-Dash style=font-size:9pt;color:#999 data-toggle=tooltip data-placement=top title="1 article">Dash</a>&nbsp; <a href=/tags/#tag-API style=font-size:9pt;color:#999 data-toggle=tooltip data-placement=top title="1 article">API</a>&nbsp; <a href=/tags/#tag-wine style=font-size:9pt;color:#999 data-toggle=tooltip data-placement=top title="1 article">wine</a>&nbsp; <a href=/tags/#tag-插件 style=font-size:18pt;color:#000 data-toggle=tooltip data-placement=top title="3 articles">插件</a>&nbsp;<h4 class="page-header text-muted"><i class="fa fa-external-link"></i> Links</h4><ul class="link-list fa-ul"><li><i class="fa-li fa fa-link"></i><a href=https://upclinux.github.io data-toggle=tooltip data-placement=bottom title=https://upclinux.github.io>UPC Linux</a></li><li><i class="fa-li fa fa-link"></i><a href=https://upclinux.github.io/intro/ data-toggle=tooltip data-placement=bottom title="https://upclinux.github.io/intro/">UPC Linux / Intro</a></li><li><i class="fa-li fa fa-link"></i><a href=http://www.lihuanyu.com data-toggle=tooltip data-placement=bottom title=http://www.lihuanyu.com>环宇的博客</a></li><li><i class="fa-li fa fa-link"></i><a href=http://wangchenyu.net.cn data-toggle=tooltip data-placement=bottom title=http://wangchenyu.net.cn>微尘风景BBS</a></li><li><i class="fa-li fa fa-link"></i><a href=http://jerry.weighingproduct.com data-toggle=tooltip data-placement=bottom title=http://jerry.weighingproduct.com>Jerry Yuan</a></li></ul></div><script type=text/javascript src=//cdnjs.cloudflare.com/ajax/libs/anchor-js/1.1.1/anchor.min.js></script><script type=text/javascript>anchors.options.placement="left",anchors.add("article h1,h2,h3,h4");</script><script type=text/javascript src=/static/js/callout.js></script><div id=top data-toggle=tooltip data-placement=left title="Back to top"><a href=javascript:;><div class=arrow></div><div class=stick></div></a></div><footer class=site-footer><div class=container><ol class=footer-list><li>&copy; 2015 vjudge1</li><li><a href="/about/">About</a></li><li><a href=mailto:vjudge404@gmail.com>Email</a></li><li><a href=https://github.com/vjudge1>GitHub</a></li><li><a href=https://twitter.com/vjudge404>Twitter</a></li><li><a href=https://www.facebook.com/vjudge404>Facebook</a></li></ol></div></footer><div style=display:none><script src="//s95.cnzz.com/z_stat.php?id=1256463916&web_id=1256463916"></script></div></body></html>